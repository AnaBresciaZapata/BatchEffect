% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sexmm_contamination.R
\name{Sexmm_contamination}
\alias{Sexmm_contamination}
\title{Detect sex mismatch and contamination in RNA-seq samples}
\usage{
Sexmm_contamination(
  counts,
  metadata,
  chrY_genes_vector,
  contamination_slope,
  contamination_fraction,
  plot_title
)
}
\arguments{
\item{counts}{A numeric matrix or data frame with genes in rows and samples in columns.
Row names should be ENSEMBL gene IDs. The column names should be sample IDs.}

\item{metadata}{A data frame with at least two columns:
\itemize{
  \item{\code{ID}:} Sample identifiers matching \code{colnames(counts)}
  \item{\code{Sex}:} Biological sex ("Male" or "Female")
}}

\item{contamination_slope}{Either `"estimated"` or a numeric value in degrees (e.g. 45).}

\item{contamination_fraction}{Numeric value (recommended 0.3) controlling the angular range
of the contamination area.}

\item{plot_title}{Character. Title to display in the plot.}

\item{chrY_genes}{A character vector of ENSEMBL gene IDs located on chromosome Y.}
}
\value{
A list with:
\describe{
  \item{plot}{A \code{ggplot2} object with the contamination/mismatch plot.}
  \item{status_table}{The status table with columns for contamination
                  and mismatch status.}
  \item{genes_cpm}{The CPM-normalized expression matrix.}
}
}
\description{
This function evaluates potential sex mismatches and contamination in RNA-seq datasets
based on expression of the \code{XIST} gene and Y chromosome genes. It produces
a scatter plot of normalized expression values, classifies samples, and updates a
filter table for downstream QC.
}
\examples{
\dontrun{
  result <- sexmm_contamination(
    counts = counts_matrix,
    metadata = metadata_df,
    chrY_genes = chrY_vector,
    contamination_slope = "estimated",
    contamination_fraction = 0.3,
    plot_title = "Dataset1"
  )
  print(result$plot)
  head(result$status_table)
}
}
