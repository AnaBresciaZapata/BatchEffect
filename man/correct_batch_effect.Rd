% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correct_batch_effect.R
\name{correct_batch_effect}
\alias{correct_batch_effect}
\title{Corrección de efecto batch en datos de expresión génica}
\usage{
correct_batch_effect(ref_batch_n, counts, metadata, replicates)
}
\arguments{
\item{ref_batch_n}{Integer. Número del batch que se utilizará como referencia para la normalización.}

\item{counts}{Matrix. Matriz de conteos crudos con genes en filas y muestras en columnas. Deben ser enteros.}

\item{metadata}{Data frame. Debe tener dos columnas: \code{SampleType} (tipo de muestra: control, enfermedad, replicado, etc.)
y \code{Batch} (número de batch). Los nombres de fila deben corresponder a las muestras y coincidir con las columnas de \code{counts}.}

\item{replicates}{Character vector. Etiquetas en \code{SampleType} que indican cuáles muestras son replicados entre batches.}
}
\value{
Una lista con los siguientes elementos:
\describe{
  \item{counts_corrected}{Matriz de conteos corregidos}
  \item{adjustment_report}{Factores de corrección aplicados por gen y por batch}
  \item{cpm}{Matriz original convertida a CPM}
  \item{cpm_corrected}{Matriz corregida convertida a CPM}
}
}
\description{
Esta función corrige el efecto batch en datos de expresión génica utilizando muestras replicadas como anclaje.
Convierte los conteos a CPM (counts per million), calcula los factores de ajuste por gen entre batches,
y aplica la corrección a los batches no de referencia. Luego devuelve tanto los conteos como los CPM corregidos.
}
